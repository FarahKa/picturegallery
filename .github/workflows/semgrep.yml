name: Semgrep
on:
    workflow_dispatch:
    workflow_call:
    pull_request:

jobs:
    semgrep_actions:
        name: Semgrep
        runs-on: ubuntu-latest
        container:
          image: returntocorp/semgrep
        steps:
          - name: ðŸ”„ Checkout
            uses: actions/checkout@v3
    
          - name: ðŸ”Ž Run semgrep analysis for GitHub Action
            run: semgrep ci --sarif --output=semgrep.sarif
    
          - name: ðŸ“¨ Upload SARIF file to GitHub
            uses: github/codeql-action/upload-sarif@v2
            continue-on-error: true
            with:
              sarif_file: semgrep-gha.sarif
            if: always()
